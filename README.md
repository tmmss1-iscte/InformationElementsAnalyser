# InformationElementsAnalyser

This repository contains a software tool to analyse Information Elements (IEs) from probe request messages.
This tool analyzes the Information Elements of probe requests that are contained in a database, generating data analyses at various levels. 
It can also write/generate a report for each analysis (i.e., each time the tool is run) into a text file.

This tool was used to determine what information should be considered or ignored from the Information Elements of probe request messages, in order to develop a fingerprinting algorithm to uniquely identify mobile devices. More details about this tool and this work are available [here](https://repositorio.iscte-iul.pt/handle/10071/29505).

Besides the software tool, this repository also contains the software for collecting and storing the data in the apropriated format for subsequent analysis by the tool.

***IMPORTANT NOTES:***
 * The software is meant to be spefically run on a device with Kali Linux OS installed.
 * Please clone this repository at the '/home/kali/Desktop' folder of your device and not move any file from its original path, otherwise you may compromisse the executability of the software.
 

## informationElementsAnalyser.py

This script analyzes the Information Elements of probe requests messages stored in a local database and generates a report for each analysis to a text file.

This script performs several analyzes divided into several stages, in the following order:

1. **Informações Gerais ->** retrives a statistical/general analysis of the data, including:
   * Total number of Probe Requests (with random MAC addresses);
   * Total number of distinct MAC addresses;
   * Total number of distinct footprints;
   * Ratio between #Footprints and #MAC_addresses;
   * Number of MAC addresses with only 1 footprint;
   * Number of MAC addresses with multiple footprints;
   
3. **Endereços MAC diferentes ->** retrieves the MAC addresses with more than 1 footprint and the footprints generated for each MAC address
   
5. **Information Elements utilizados ->** retrieves the Information Elements used in each footprint for each MAC address
   
7. **Information Elements diferentes ->** retrieves the Information Elements and the bytes/bits that varied for each MAC address. It is possible to choose the level of granularity of this analyis between three levels:
     1. 'show-bits-variation' -> show the variation on bit level (the most detailed level of analysis);
     2. 'show-bytes-variation' -> show the variation on byte level;
     3. 'no-variation' -> show only the Information Elements that varied (the less detailed level of analysis);
   
9. **Definitely variable bytes/bits ->** retrieves what bytes/bits from the Information Elements are considered as "Definitely variable".
    
11. **Possibly variable bytes/bits ->** retrieves what bytes/bits from the Information Elements are considered as "Possibly variable". 
    
13. **Information Elements Presence Rate ->** retrieves the percentage of presence of each Information Element from all probe request messages in the database.
    
15. **Vendor Specific Information ->** retrives the percentage of presence of the Vendor Specific information from all probe request messages in the database.


***NOTE:*** Unfortunately, some comments and code are written in portuguese, as this project was initially developed and not intended to be publicly available online.

## env_variables.py

(Falar das variaveis de ambiente e das suas funções por bullet points)













## example
This folder contains example files with preloaded data that can be used to verify the output generated by the analysis tool. The folder contains two files: PublicDataset.db and PublicDataset.txt, and they correspond to the database with data from a public dataset and the respective output report file, which were used to validate the information to be considered/ignored for each Information Element to generate the footprint.

To use this data as tool input, simply change the 'input_db_filepath' environment variable with the path to the 'PublicDataset.db' database.
    
## aircrack-ng

 This software does not make part of the analysis tool itself. Instead, this software is only available to collect the data and inserting it in the correct format in the local database.
 
The 'aircrack-ng' directory contains the software for the data collection. In particular, the 'airodump-ng' tool was purposefully customized in order to collect the necessary data and insert it into a local database.

The 'airodump-ng' suite does the following:
* Only probe request messages with a random source MAC address are captured. (Probe requests with a real MAC address can be uniquely identified from its MAC address, and so, there is no relevance in collecting those messages);
* For each probe request, the source MAC address, a footprint, the Information Elements, the RSSID, and the SEQ number are analysed, and stored in the 'InformationElements.db' database.
* Each Information Element (IE) is represented by three fields (IE_ID, IE_length, and IE_value). As some of this IEs are substantly varying by nature (e.g., SSID or DS_Parameter_Set), the entire information of somes IEs is not analyser nor stored in the database. The information considered from each Information Element of each probe request is presented in the 'footprint_ies_considered.csv' file. This is also the information used to generate the device footprints. The data of each IE is stored in hexadecimal format.

### Instalation

To install this specific custom-made 'aircrack-ng' version, do the following steps:
1. Uninstall the original aircrack-ng suite from the apt repository (if exists):
```
sudo apt-get remove aircrack-ng
```
3. Install all requirements. You can check the requirements in the official documentation page of aircrack-ng available [here](https://www.aircrack-ng.org/doku.php?id=install_aircrack#installing_aircrack-ng_from_source).
4. Install this specific version of the 'aircrack-ng' suite:
```
cd aircrack-ng-1.7
 autoreconf -i
 ./configure
 make
 sudo make install
 sudo ldconfig
```

***NOTES:***
* This specific aircrack-ng version requires a prior SQLite3 version instead of the latest version of the SQLite3. As so, you may also need to uninstall the original sqlite3 packages from the apt repository and install a prior version of SQLite3. In this case, the version 3.39.0 was installed and used for this specific version of aircrack-ng. You can also install this SQLite3 version by doing following the steps:
  1. Uninstall the latest version of SQLite3 from the apt repository:
  ```
  sudo apt-get remove sqlite3
  ```
  2. Do the following steps:
  ```
  cd sqlite-autoconf-3390000
  ./configure
  make
  sudo make install
  ```
  3. Once this commands suceed, you can check your SQLite3 version:
  ```
  sqlite3 --version
  ```

### Collected data

Having installed this specific version of the 'aircrack-ng' suite, you can collect the probe requests messages by doing the following steps:
1. Check what wireless interfaces you have available on your device (```sudo airmon-ng```). A list of the wireless interfaces is returned.
2. Set the wireless interface in monitor mode (```sudo airmon-ng start <wlan>```).
3. Start sniffing probe request messages(```sudo airodump-ng --background 1 <wlan>```). The 'airodump-ng' will start collecting data and insert it on the 'Information_Elements.db' database.

## DB

This directory contains the database where the collected data is written by the 'airodump-ng' suite. The 'airodump-ng' is has hardcoded the database filepath '/home/kali/Desktop/InformationElementsAnalyser/DB/InformationElements.db' to write the collected data, so please do not change the location of this file in any circunstance.

This database is empty and contains only one table (Information_Elements). The information of each probe request message is stored in a row of this table.

The schema of the Information_Elements table is the following:

CREATE TABLE `Information_Elements` ( \
 `MAC_Address`  text , \
 `Footprint` text, \
 `IE_array` text, \
 `Supp_Rates` text, \
 `Extended_Supp_Rates` text, \
 `DS_Parameter` text, \
 `HT_Capabilities` text, \
 `Extended_Capabilities` text, \
 `VHT_Capabilities` text, \
 `RM_enabled_Capabilities` text, \
 `Interworking` text, \
 `Supp_Operating_Classes` text, \
 `Vendor_1` text, \
 `Vendor_2` text, \
 `Vendor_3` text, \
 `Vendor_4` text, \
 `Timestamp` datetime, \
 `Power` text, \
 `Manufacturer` text, \
 `SEQ` INTEGER \
);








