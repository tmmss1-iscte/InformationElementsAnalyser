# InformationElementsAnalyser

This repository contains a software tool to analyse Information Elements (IEs) from probe request messages.
This tool analyzes the Information Elements of probe requests that are contained in a database, generating data analyses at various levels. 
It can also write/generate a report for each analysis (i.e., each time the tool is run) into a text file.

This tool was used to determine what information should be considered or ignored from the Information Elements of probe request messages, in order to develop a fingerprinting algorithm to uniquely identify mobile devices. More details about this tool and this work are available [here](https://repositorio.iscte-iul.pt/handle/10071/29505).

Besides the software tool, this repository also contains the software for collecting and storing the data in the apropriated format for subsequent analysis by the tool.

***IMPORTANT NOTES:***
 * The software is meant to be spefically run on a device with Kali Linux OS installed.
 * Please clone this repository at the '/home/kali/Desktop' folder of your device and not move any file from its original path, otherwise you may compromisse the executability of the software.
 

## informationElementsAnalyser.py

This script analyzes the Information Elements of probe requests messages stored in a local database and generates a report for each analysis to a text file.

This script performs several analyzes divided into several stages, in the following order:

1. **Informações Gerais ->** retrieves a statistical/general analysis of the data contained in the input database, including:
   * Total number of Probe Requests (with random MAC addresses);
   * Total number of distinct MAC addresses;
   * Total number of distinct footprints;
   * Ratio between #MAC_addresses and #Footprints;
   * Number of MAC addresses with only 1 footprint;
   * Number of MAC addresses with multiple footprints;
   
3. **Endereços MAC diferentes ->** retrieves the MAC addresses with more than 1 footprint and the footprints generated for each MAC address;
   
5. **Information Elements utilizados ->** retrieves the Information Elements used in each footprint for each MAC address;
   
7. **Information Elements diferentes ->** retrieves the Information Elements and the bytes/bits that varied for each MAC address. It is possible to choose the level of granularity of this analyis between three levels:
     1. 'show-bits-variation' -> show the variation on bit level (the most detailed level of analysis);
     2. 'show-bytes-variation' -> show the variation on byte level;
     3. 'no-variation' -> show only the Information Elements that varied (the less detailed level of analysis);
   
9. **Definitely variable bytes/bits ->** retrieves what bytes/bits from the Information Elements are considered as "Definitely variable".
    
11. **Possibly variable bytes/bits ->** retrieves what bytes/bits from the Information Elements are considered as "Possibly variable". 
    
13. **Information Elements Presence Rate ->** retrieves the percentage of presence of each Information Element from all probe request messages in the database.
    
15. **Vendor Specific Information ->** retrives the percentage of presence of the Vendor Specific information from all probe request messages in the database.


***NOTE:*** Unfortunately, some comments and code are written in portuguese, as this project was initially developed and not intended to be publicly available online.

## env_variables.py

The env_variables.py file contains the environment variaables of this software analysis tool.

## main.py

To run the software analysis tool, simply execute this script (```python3 main.py```).

## example
This folder contains example files with preloaded data that can be used to verify the output generated by the analysis tool. The folder contains two files: 'PublicDataset.db' and 'PublicDataset.txt', and they correspond to the database with data from a [public labelled dataset of Wi-Fi probe request messages](https://www.sciencedirect.com/science/article/abs/pii/S1389128622000196) and the respective output report file, which were used to validate the information to be considered/ignored for each Information Element to generate the footprint in a previous master's dissertation work.

To use this data as tool input, simply change the 'input_db_filepath' environment variable with the path to the 'PublicDataset.db' database in this folder.

## Requirements

This software analysis tool only requires the instalation of the ```simple-colors``` library through pip:

```pip install simple-colors```


## aircrack-ng

The software in this folder does not make part of the analysis tool itself. Instead, this software is only available to collect the data and inserting it in the correct format in the local database.
 
For more information about how to collect data in the appropriated format, go check the README.md file on this folder.

## DB

This folder contains the database where the collected data is written by the 'airodump-ng' suite. 

The 'airodump-ng' is has hardcoded the database filepath '/home/kali/Desktop/InformationElementsAnalyser/DB/InformationElements.db' to write the collected data, so please do not change the location of this file in any circunstance.

This database is empty and contains only one table (Information_Elements). The information of each probe request message is stored in a row of this table.

The schema of the Information_Elements table is the following:

CREATE TABLE `Information_Elements` ( \
 `MAC_Address`  text , \
 `Footprint` text, \
 `IE_array` text, \
 `Supp_Rates` text, \
 `Extended_Supp_Rates` text, \
 `DS_Parameter` text, \
 `HT_Capabilities` text, \
 `Extended_Capabilities` text, \
 `VHT_Capabilities` text, \
 `RM_enabled_Capabilities` text, \
 `Interworking` text, \
 `Supp_Operating_Classes` text, \
 `Vendor_1` text, \
 `Vendor_2` text, \
 `Vendor_3` text, \
 `Vendor_4` text, \
 `Timestamp` datetime, \
 `Power` text, \
 `Manufacturer` text, \
 `SEQ` INTEGER \
);








